-- -------------------------separate folder and a new file for each manager

Sub SaveMe()

Application.ScreenUpdating = False

Dim MyReqTime As String          'Holds the Territory Manager "Code"
Dim MySavedPath As Variant   'Holds the path to save the file
Dim MyRecordedFileName As String    'Holds the file name
Dim MY As Integer       'Holds the year
Dim MM As Integer      'Holds the month
Dim MD As Integer        'Holds the day

MY = Year(Now)
 MM = Month(Now)
 MD = Day(Now)


MyReqTime = Left(ActiveSheet.Name, 4)
MySavedPath = Application.WorksheetFunction.VLookup(MyTm, Range("TMSavePath"), 2, False)


    ActiveSheet.Copy

    
    ActiveWorkbook.SaveAs Filename:= _
     MySavedPath & "\" & MY & MM & MD & "_" & ActiveSheet.Name & ".xlsx"
    
    
    
    ActiveWindow.Close

Application.ScreenUpdating = True

End Sub
--------------------------------------------------------------------

------ Extract values not found in the second list from the first list


Option Base 1   'Ensure Arrays begin at 1


Sub Test()
'Loading all the array at once

Dim Array1234() As Variant    'Declare the array
Dim RC As Integer     'Get the count of the rows of data
Dim x As Integer    'Loop to write data

    'Turn off screen updating (MUST be turned back on at the end)
    Application.ScreenUpdating = False
    'Turn off automatic calculation (MUST be turned back on at the end)
    Application.Calculation = xlCalculationManual
    
    'Clear old written data
    Range("D:E").ClearContents
    
    'Add start time (just for clocking the speed)
    Range("G1").Value = Time()


'Read the data
    'Load the array
    Array1234 = Range("A1").CurrentRegion
    
    'Get the count of rows in the array
    RC = UBound(Array1234)

'Write the data
    'Selet start of "write" range
    Range("D1").Select
    
    On Error Resume Next
        For x = 1 To RC
            If IsError _
                (WorksheetFunction.Match _
                (MyArray(x, 1), Range("MyNamedRange"), 0)) Then
                ActiveCell.Value = Array1234(x, 1)
                ActiveCell.Offset(0, 1).Value = Array1234(x, 2)
                ActiveCell.Offset(1, 0).Select
            Else
                'Do nothing
            End If
        Next x
    On Error GoTo 0


    'Add stop time
    Range("G2").Value = Time()
    
    'Turn autocalculate back on
    Application.Calculation = xlCalculationAutomatic
    
    'Turn screen updating back on
    Application.ScreenUpdating = False

End Sub


---------------------------------------------------------------------------------




